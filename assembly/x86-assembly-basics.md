# X86 Assembly Basics

### X86 Assembly Language

The C programming is a high level language interpreted by the compiler that converts code into machine instructions called assembly language. By using a disassembler tool we can get the assembly language of a compiled C program.

The Intel 8086 and 8088 were the first CPUs to have an instruction set that is now commonly referred to as **x86**. Intel Architecture 32-bit \(IA-32\) sometimes also called i386 is the 32-bit version of the x86 instruction set architecture.

The x86 architecture is **little-endian**, meaning that multi-byte values are written least significant byte first.

**How we see it:**

```text
| A0 | A1 | A2 | A3 |
```

**Stored as Little Endian**

```text
| A3 | A2 | A1 | A0 |
```

### Opcodes and Instructions

Each Instruction represents opcodes \(hex code\) that tell the machine what to do next.

Three categories of instructions:

* Data Movement/Access
* Arithmetic / Logic
* Control-Flow

#### Common Instructions

* **mov, lea** \(data movement, data access\)
* **add, sub** \(arithmetic\)
* **or, and, xor** \(Logic\)
* **shr, shl** \(Logic\)
* **ror, rol** \(Logic\)
* **jmp, jne, jnz, jnb** \(Control Flow\)
* **push, pop, call, leave, enter, ret** \(Control Flow\)

Example below is moving value at 0xaaaaaaaa into ecx.

<table>
  <thead>
    <tr>
      <th style="text-align:left">
        <p><b><code>Instruction</code></b>
        </p>
        <p><code>mov ecx,[0xaaaaaaaa];</code>
        </p>
      </th>
      <th style="text-align:left">
        <p><b><code>Opcode</code></b>
        </p>
        <p><code>8B 0D AA AA AA AA</code>
        </p>
      </th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

### Registers

#### General-Purpose Registers[ \[1\]](https://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture)

| **Register** | **Description** |
| :--- | :--- |
| **EAX** | Accumulator Register |
| **EBX** | Base Register |
| **ECX** | Counter Register |
| **EDX** | Data Register |
| **ESI** | Source Index |
| **EDI** | Destination Index |
| **EBP** | Base Pointer |
| **ESP** | Stack Pointer |

#### Instruction Pointer

The **EIP** register contains the address of the next instruction to be executed.

#### Segment Registers

| **Register** | **Description** |
| :--- | :--- |
| SS | Stack Segment, Pointer to the stack |
| CS | Code Segment, Pointer to the code |
| DS | Data Segment, Pointer to the data |
| ES | Extra Segment, Pointer to extra data |
| FS | F Segment, Pointer to more extra data |
| GS | G Segment, Pointer to still more extra data |

#### EFLAGS Registers

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>ID</b>
      </th>
      <th style="text-align:left"><b>Name</b>
      </th>
      <th style="text-align:left"><b>Description</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">CF</td>
      <td style="text-align:left">Carry Flag</td>
      <td style="text-align:left">Set if the last arithmetic operation carried (addition) or borrowed (subtraction)
        a bit beyond the size of the register. This is then checked when the operation
        is followed with an add-with-carry or subtract-with-borrow to deal with
        values too large for just one register to contain</td>
    </tr>
    <tr>
      <td style="text-align:left">PF</td>
      <td style="text-align:left">Parity Flag</td>
      <td style="text-align:left">Set if the number of set bits in the least significant byte is a multiple
        of 2</td>
    </tr>
    <tr>
      <td style="text-align:left">AF</td>
      <td style="text-align:left">Adjust Flag</td>
      <td style="text-align:left">Carry of Binary Code Decimal (BCD) numbers arithmetic operations</td>
    </tr>
    <tr>
      <td style="text-align:left">ZF</td>
      <td style="text-align:left">Zero Flag</td>
      <td style="text-align:left">Set if the result of an operation is Zero (0)</td>
    </tr>
    <tr>
      <td style="text-align:left">SF</td>
      <td style="text-align:left">Sign Flag</td>
      <td style="text-align:left">Set if the result of an operation is negative</td>
    </tr>
    <tr>
      <td style="text-align:left">TF</td>
      <td style="text-align:left">Trap Flag</td>
      <td style="text-align:left">Set if step by step debugging</td>
    </tr>
    <tr>
      <td style="text-align:left">IF</td>
      <td style="text-align:left">Interruption Flag</td>
      <td style="text-align:left">Set if interrupts are enabled</td>
    </tr>
    <tr>
      <td style="text-align:left">DF</td>
      <td style="text-align:left">Direction Flag</td>
      <td style="text-align:left">Stream direction. If set, string operations will decrement their pointer
        rather than incrementing it, reading memory backwards</td>
    </tr>
    <tr>
      <td style="text-align:left">OF</td>
      <td style="text-align:left">Overflow Flag</td>
      <td style="text-align:left">Set if signed arithmetic operations result in a value too large for the
        register to contain</td>
    </tr>
    <tr>
      <td style="text-align:left">IOPL</td>
      <td style="text-align:left">I/O Privilege Level field (2 bits)</td>
      <td style="text-align:left">I/O Privilege Level of the current process</td>
    </tr>
    <tr>
      <td style="text-align:left">NT</td>
      <td style="text-align:left">Nested Task flag</td>
      <td style="text-align:left">Controls chaining of interrupts. Set if the current process is linked
        to the next process</td>
    </tr>
    <tr>
      <td style="text-align:left">RF</td>
      <td style="text-align:left">Resume Flag</td>
      <td style="text-align:left">Response to debug exceptions</td>
    </tr>
    <tr>
      <td style="text-align:left">VM</td>
      <td style="text-align:left">Virtual-8086 Mode</td>
      <td style="text-align:left">Set if in 8086 compatibility mode</td>
    </tr>
    <tr>
      <td style="text-align:left">AC</td>
      <td style="text-align:left">Alignment Check</td>
      <td style="text-align:left">Set if alignment checking of memory references is done</td>
    </tr>
    <tr>
      <td style="text-align:left">VIF</td>
      <td style="text-align:left">Virtual Interrupt Flag</td>
      <td style="text-align:left">Virtual image of IF</td>
    </tr>
    <tr>
      <td style="text-align:left">VIP</td>
      <td style="text-align:left">Virtual Interrupt Pending flag</td>
      <td style="text-align:left">Set if an interrupt is pending</td>
    </tr>
    <tr>
      <td style="text-align:left">ID</td>
      <td style="text-align:left">
        <p>Identification</p>
        <p>Flag</p>
      </td>
      <td style="text-align:left">Su</td>
    </tr>
  </tbody>
</table>



